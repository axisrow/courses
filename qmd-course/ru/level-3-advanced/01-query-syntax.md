---
title: "Продвинутый синтаксис запросов"
weight: 11
bookToc: true
---

# Продвинутый синтаксис запросов

## Query Markup Documents

У QMD есть собственный язык запросов. Вместо одной строки поиска можно писать структурированные многострочные запросы с разными типами поиска.

## Типы запросов

| Тип | Метод | Описание |
|-----|-------|----------|
| `lex` | BM25 | Поиск по ключевым словам |
| `vec` | Вектор | Семантическое сходство |
| `hyde` | Вектор | Гипотетический документ-ответ |
| `expand` | LLM | Автоматическая генерация lex/vec/hyde |

## Поведение по умолчанию

Запрос без типа обрабатывается как `expand:`:

```sh
# Эквивалентны:
qmd query "как работает аутентификация"
qmd query "expand: как работает аутентификация"
```

## Синтаксис lex-запросов

| Синтаксис | Значение | Пример |
|-----------|----------|--------|
| `слово` | Префиксное совпадение | `perf` → "performance" |
| `"фраза"` | Точная фраза | `"rate limiter"` |
| `-слово` | Исключить | `-sports` |
| `-"фраза"` | Исключить фразу | `-"test data"` |

```sh
qmd query 'lex: "machine learning" -"deep learning"'
```

## Vec-запросы

Пишите вопросы на естественном языке:

```sh
qmd query 'vec: как rate limiter обрабатывает всплески трафика'
```

## Hyde-запросы

Напишите гипотетический ответ (50–100 слов):

```sh
qmd query 'hyde: Rate limiter использует алгоритм скользящего окна с 60-секундным интервалом...'
```

## Многострочные запросы

Комбинируйте типы. Первый запрос получает двойной вес:

```sh
qmd query $'lex: rate limiter algorithm\nvec: how does rate limiting work\nhyde: The API implements rate limiting using a token bucket...'
```

## Ограничения

- Максимум один `expand:` на запрос
- Операторы lex (`-term`, `"phrase"`) работают только в lex-запросах
- Пустые строки игнорируются

## Далее

Разберём, как работает гибридный поиск и ранжирование изнутри.
