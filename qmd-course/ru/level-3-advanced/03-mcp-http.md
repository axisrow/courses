---
title: "MCP HTTP-сервер"
weight: 13
bookToc: true
---

# MCP HTTP-сервер

## Stdio vs HTTP

По умолчанию MCP-сервер QMD работает как подпроцесс (stdio). Каждый клиент запускает свою копию и загружает модели заново. Для общего, постоянно работающего сервера используйте HTTP-транспорт.

## Запуск HTTP-сервера

```sh
# На переднем плане
qmd mcp --http                    # localhost:8181
qmd mcp --http --port 8080        # свой порт

# Фоновый демон
qmd mcp --http --daemon
```

## Остановка

```sh
qmd mcp stop
```

## Проверка статуса

```sh
qmd status
# Показывает "MCP: running (PID ...)"
```

## HTTP-эндпоинты

| Эндпоинт | Метод | Описание |
|----------|-------|----------|
| `/mcp` | POST | MCP Streamable HTTP (JSON) |
| `/health` | GET | Проверка работоспособности |

## Подключение

Укажите клиенту адрес: `http://localhost:8181/mcp`

## Преимущества производительности

- Модели остаются загруженными в памяти GPU
- Первый запрос: ~1 секунда
- Последующие запросы: почти мгновенно
- Контексты освобождаются через 5 минут бездействия

## Когда использовать

**HTTP**: несколько агентов, частые запросы, нужна скорость.

**Stdio**: один клиент, простота важнее скорости.

## Безопасность

Сервер слушает только на `localhost`. Для удалённого доступа используйте обратный прокси с аутентификацией.

## Далее

Изучим алгоритм умной нарезки документов.
