---
title: "Суб-агенты"
weight: 1
bookToc: true
---

# Суб-агенты

## Введение

Одна из самых мощных возможностей DeerFlow — это **суб-агенты**. Представьте, что у вас есть руководитель проекта, который может нанять помощников для параллельного выполнения разных частей задачи. Именно так работает система суб-агентов.

## Как устроена система суб-агентов

### Главный агент (Lead Agent)

**Главный агент** — это «мозг» DeerFlow. Он получает вашу задачу и решает, нужно ли привлекать помощников. Если задача сложная, он разбивает её на подзадачи и создаёт суб-агентов.

### Суб-агенты

**Суб-агент** — это отдельный ИИ-помощник, который:
- Работает в **изолированном контексте** (не видит, что делают другие)
- Имеет собственный набор **инструментов**
- Выполняет **одну конкретную подзадачу**
- Возвращает **структурированный результат** главному агенту

### Типы встроенных суб-агентов

| Тип | Описание | Инструменты |
|-----|----------|-------------|
| `general-purpose` | Универсальный помощник | Все, кроме делегирования |
| `bash` | Специалист по командам | Только bash-команды |

## Как это работает

```
Ваш запрос: "Сравни React, Vue и Angular"
            ↓
Главный агент создаёт 3 суб-агента:
  ├─ Суб-агент 1: исследует React     ← работают
  ├─ Суб-агент 2: исследует Vue        ← параллельно
  └─ Суб-агент 3: исследует Angular    ← (одновременно!)
            ↓
Результаты собираются → финальное сравнение
```

## Ограничения

- **Максимум 3 суб-агента** одновременно (настраивается)
- **Таймаут 15 минут** на каждого суб-агента
- Суб-агент **не может** создавать своих суб-агентов (только один уровень вложенности)

## Инструмент `task`

Главный агент делегирует задачи через инструмент `task`:

```
task(
  description="Исследовать React",
  prompt="Найди информацию о React...",
  subagent_type="general-purpose",
  max_turns=10
)
```

- **description** — краткое описание задачи
- **prompt** — подробная инструкция
- **subagent_type** — тип суб-агента
- **max_turns** — максимальное число шагов

## Включение суб-агентов

В файле `config.yaml`:

```yaml
subagents:
  enabled: true  # включить суб-агентов
```

Также можно включить через параметр при запуске:

```json
{
  "configurable": {
    "subagent_enabled": true
  }
}
```

## Жизненный цикл суб-агента

1. **task_started** — суб-агент создан и начал работу
2. **task_running** — суб-агент выполняет задачу (обновления каждые 5 секунд)
3. **task_completed** — задача выполнена успешно
4. **task_failed** — произошла ошибка
5. **task_timed_out** — время вышло (15 минут)

Все эти события отображаются в интерфейсе в реальном времени.

## Практический пример

Попробуйте этот запрос:

```
Мне нужен полный обзор трёх баз данных: PostgreSQL, MongoDB и Redis.
Для каждой базы:
- Описание и тип
- Сильные и слабые стороны
- Типичные сценарии использования
- Пример подключения на Python

Затем создай сравнительную таблицу.
```

DeerFlow создаст суб-агента для каждой базы данных, они будут работать параллельно, а главный агент соберёт результаты в финальный отчёт.

## Итоги

- Суб-агенты позволяют выполнять несколько задач параллельно
- Каждый суб-агент работает в изолированном контексте
- Максимум 3 суб-агента одновременно, таймаут 15 минут
- Встроенные типы: `general-purpose` и `bash`
- Главный агент координирует суб-агентов и собирает результаты
