---
title: "Преобразование данных"
weight: 7
bookToc: true
---

# Преобразование данных

## Зачем преобразовывать?

Данные из одного сервиса редко подходят другому. Нужно переименовывать поля, фильтровать, объединять и вычислять новые значения.

## Выражения (Expressions)

Синтаксис `{{ }}`:

- `{{ $json.name }}` — доступ к полю
- `{{ $json.price * 1.2 }}` — вычисление
- `{{ $json.name.toUpperCase() }}` — преобразование текста
- `{{ $json.date.split('T')[0] }}` — извлечение части строки

### Специальные переменные
- `$json` — данные текущего элемента
- `$input` — все входные данные
- `$node["NodeName"].json` — данные из конкретного нода
- `$now` — текущая дата/время

## Ключевые ноды преобразования

### Set
Переименование, добавление, удаление полей. Опция **Keep Only Set** убирает всё лишнее.

### Code
JavaScript или Python для сложных преобразований:

```javascript
return items.map(item => {
  item.json.fullName = item.json.firstName + ' ' + item.json.lastName;
  item.json.isAdult = item.json.age >= 18;
  return item;
});
```

### Split Out
Массив → отдельные элементы. Вход: 1 элемент с `tags: ["a", "b", "c"]`. Выход: 3 элемента.

### Aggregate
Несколько элементов → один с массивом всех значений.

### Sort / Limit / Remove Duplicates
Сортировка, ограничение количества, удаление дубликатов.

## Типичные паттерны

### Переименование полей
```
Set → "email" = {{ $json.contact_email }} → Keep Only Set: ON
```

### Фильтрация
```
IF → {{ $json.status }} equals "active" → только активные проходят
```

### Объединение источников
```
Merge → режим Combine → соединение по общему полю
```

## Практика

1. Получите список пользователей: `https://jsonplaceholder.typicode.com/users`
2. Извлеките `name`, `email` и `city` (из `address.city`)
3. Отсортируйте по имени
4. Оставьте первые 5

## Итог

Вы умеете преобразовывать данные. Далее — обработка ошибок.
