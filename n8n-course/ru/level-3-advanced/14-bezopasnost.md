---
title: "Лучшие практики безопасности"
weight: 14
bookToc: true
---

# Лучшие практики безопасности

## Почему это важно

Workflow часто работают с чувствительными данными: API-ключи, данные пользователей, пароли. Одна ошибка может всё раскрыть.

## Управление учётными данными

- **Никогда** не вписывайте ключи прямо в параметры нодов
- Используйте систему Credentials
- Данные шифруются при хранении
- Регулярно обновляйте ключи (каждые 90 дней)
- Удаляйте неиспользуемые

## Переменные окружения

```bash
export API_SECRET=ваш_секрет
export DB_PASSWORD=ваш_пароль
```

Доступ в workflow:
```
{{ $env.API_SECRET }}
```

## Безопасность вебхуков

### Аутентификация
- **Basic Auth** — логин/пароль
- **Header Auth** — секретный токен в заголовке
- **IP Whitelist** — только определённые IP

### Валидация входных данных
```
Webhook → IF (поля существуют?) → IF (типы верны?) → Обработка
```

### Проверка подписей
```javascript
const crypto = require('crypto');
const signature = $json.headers['x-hub-signature-256'];
const hash = 'sha256=' + crypto.createHmac('sha256', SECRET)
  .update(JSON.stringify($json.body)).digest('hex');
if (signature !== hash) throw new Error('Неверная подпись');
```

## Сетевая безопасность

- **HTTPS** — всегда шифруйте трафик
- **Reverse proxy** — Nginx или Caddy перед n8n
- **Firewall** — ограничьте доступ к порту 5678
- **VPN** — для внутреннего использования

## Контроль доступа

- Ограничьте права администратора
- Разделите продакшн и разработку
- Ведите аудит изменений
- Отключите публичный API, если не нужен

## Защита данных

- Обрабатывайте только необходимые данные
- Шифруйте чувствительные поля
- Настройте автоудаление истории выполнений

```
N8N_EXECUTIONS_DATA_PRUNE=true
N8N_EXECUTIONS_DATA_MAX_AGE=168
```

## Практика

1. Настройте вебхук с Basic Auth
2. Добавьте валидацию
3. Используйте Credentials
4. Настройте автоудаление данных выполнений

## Итог

Безопасность обязательна. Далее — деплой в продакшн.
