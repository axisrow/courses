---
title: "Производительность и масштабирование"
weight: 13
bookToc: true
---

# Производительность и масштабирование

## Когда это важно

При росте workflow вы столкнётесь с:
- Медленными выполнениями
- Проблемами с памятью
- Таймаутами
- Большим числом параллельных запусков

## Обработка больших данных

### Split In Batches
Обработка порциями:
1. Задайте размер пакета (например, 50)
2. Обработайте каждый пакет
3. Зацикл: обратно к Split In Batches

### Limit
Если нужны только первые N элементов — ограничьте как можно раньше.

### Пагинация
Загружайте данные из API постранично.

## Настройки выполнения

### Таймаут
- По умолчанию: 300 секунд
- Увеличьте для долгих workflow
- Настраивается для каждого workflow

## Queue Mode

Для нагруженных продакшн-сред:

```bash
EXECUTIONS_MODE=queue
QUEUE_BULL_REDIS_HOST=localhost
QUEUE_BULL_REDIS_PORT=6379
```

Запуск воркеров:
```bash
n8n worker
```

Преимущества:
- Распределение нагрузки
- Больше параллельных выполнений
- Отказоустойчивость

## Оптимизация памяти

- Не загружайте всё сразу — используйте пагинацию и пакеты
- Удаляйте ненужные поля рано (Set + Keep Only Set)
- Не создавайте большие массивы в Code Node
- Стримьте бинарные данные

## Мониторинг

### История выполнений
- Время выполнения
- Процент успеха/неудач
- Объём данных

### Внешний мониторинг
```
Schedule Trigger → n8n API (статистика) → IF (ошибок > 10%) → Slack-алерт
```

## Стратегии масштабирования

| Стратегия | Когда |
|-----------|-------|
| Пакетная обработка | Большие данные |
| Queue mode | Высокий параллелизм |
| Несколько воркеров | CPU-нагрузка |
| Отдельные инстансы | Изоляция критичных workflow |

## Практика

1. Workflow для 1000 элементов через Split In Batches (по 100)
2. Замерьте время начала, конца и общую длительность
3. Сравните с обработкой без пакетов

## Итог

Вы знаете, как оптимизировать n8n. Далее — безопасность.
