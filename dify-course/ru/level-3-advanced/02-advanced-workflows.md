---
title: "Продвинутые воркфлоу"
weight: 2
bookToc: true
---

# Продвинутые воркфлоу

## За пределами простых цепочек

На Уровне 2 мы рассмотрели базовые воркфлоу. Теперь построим продакшн-пайплайны.

## Параллельное выполнение

Запускайте несколько веток одновременно:

1. От одного узла проведите связи к нескольким узлам
2. Они выполняются параллельно
3. Используйте **Присвоение переменных** для объединения результатов

**Пример**: запрос к 3 базам знаний одновременно, затем объединение ответов.

## Итерации (циклы)

Обработка списка элементов по одному:

1. Используйте узел **Код** для создания массива
2. Подключите узел **Итерация**
3. Внутри цикла обработайте каждый элемент
4. Соберите результаты

**Пример**: анализ 10 отзывов клиентов по одному.

## Обработка ошибок

- **Повтор**: установите количество повторов для HTTP и LLM узлов
- **Запасной вариант**: используйте ЕСЛИ/ИНАЧЕ для проверки ошибок
- **Значения по умолчанию**: предусмотрите запасные ответы

## Узлы с кодом

Пишите Python или JavaScript для кастомной логики:

```python
def main(inputs):
    text = inputs["text"]
    words = text.split()
    return {
        "word_count": len(words),
        "preview": " ".join(words[:20])
    }
```

## Продвинутые паттерны

### Map-Reduce
1. Разделите вход на части
2. Обработайте каждую часть через LLM (итерация)
3. Объедините результаты другим LLM

### Цепочка верификации
1. LLM генерирует ответ
2. LLM создаёт проверочные вопросы
3. LLM отвечает на проверочные вопросы
4. LLM корректирует исходный ответ

## Советы по производительности

- Минимизируйте вызовы LLM — каждый добавляет задержку
- Используйте узлы Код для логики, не требующей AI
- Кэшируйте частые результаты поиска по базе знаний

## Следующий шаг

Давайте развернём Dify для корпоративного использования!
