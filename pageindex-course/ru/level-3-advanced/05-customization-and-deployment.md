---
title: "Настройка и развёртывание"
weight: 5
bookToc: true
---

# Настройка и развёртывание

## Адаптация PageIndex под ваши задачи

## Настройка конфигурации

### Выбор модели

По умолчанию используется `gpt-4o-2024-11-20`, но можно использовать другие:

- **GPT-4o**: Лучшая точность, выше стоимость, медленнее
- **GPT-4o-mini**: Хорошая точность, ниже стоимость, быстрее

### Параметры размера узлов

```python
result = page_index(
    "document.pdf",
    max_page_num_each_node=5,     # Меньше = более детальное дерево
    max_token_num_each_node=10000  # Меньше = больше подразделений
)
```

### Диапазон обнаружения TOC

```python
result = page_index(
    "document.pdf",
    toc_check_page_num=30  # Проверить больше страниц
)
```

Увеличьте для документов, где оглавление появляется позже.

## Варианты развёртывания

### Вариант 1: Локальный (self-hosted)

**Плюсы**: Полный контроль, данные остаются у вас
**Минусы**: Нужен свой API-ключ, управление инфраструктурой

### Вариант 2: Облачный API

**Плюсы**: Не нужна установка, управляемая инфраструктура
**Минусы**: Данные покидают вашу сеть, оплата по использованию

### Вариант 3: Корпоративное развёртывание

- Частное облако или on-premises
- Кастомная интеграция моделей
- Объёмные тарифы
- Выделенная поддержка

## Продакшн-рекомендации

### Управление затратами

1. **Кэширование** — сохраняйте сгенерированные деревья для повторного использования
2. **Меньшие модели** для первичных проходов, большие — для верификации
3. **Подходящие лимиты узлов** — большие узлы = меньше API-вызовов
4. **Пакетная обработка** — в непиковые часы

### Оптимизация производительности

- PageIndex уже использует async-обработку
- Кэшируйте структуры деревьев
- Предварительно генерируйте деревья для библиотек документов

### Обработка ошибок

В продакшне учитывайте:
- Лимиты API (экспоненциальный backoff)
- Документы без полезной структуры (запасной ответ)
- Очень большие документы (тайм-ауты)
- Повреждённые или защищённые PDF (валидация перед обработкой)

## Расширение PageIndex

- **Кастомная постобработка** — добавление своих полей к узлам
- **Альтернативные модели** — адаптация API-функций для не-OpenAI моделей
- **Доменные промпты** — модификация промптов для вашей области
- **Интеграционные слои** — обёртки для конкретных задач

## Итоги

PageIndex настраивается через параметры конфигурации, развёртывается несколькими способами и расширяется для специфических задач. В продакшне важно управление затратами, кэширование и надёжная обработка ошибок.
