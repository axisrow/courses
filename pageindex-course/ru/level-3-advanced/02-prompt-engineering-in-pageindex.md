---
title: "Промпт-инженерия в PageIndex"
weight: 2
bookToc: true
---

# Промпт-инженерия в PageIndex

## Как PageIndex общается с LLM

PageIndex активно использует тщательно разработанные промпты для управления LLM. Понимание этих промптов раскрывает секрет точности системы.

## Типы промптов

### 1. Промпты обнаружения

Определяют, содержит ли страница оглавление:

- Явно исключают ложные срабатывания (списки рисунков, обозначений)
- Требуют JSON с полем «thinking»
- Бинарное решение: да/нет

### 2. Промпты извлечения

Преобразуют содержимое TOC в структурированный JSON:

- Определяют точный формат вывода с примерами
- Объясняют систему нумерации (структуру)
- Обрабатывают продолжение для длинных оглавлений

### 3. Промпты верификации

Проверяют, действительно ли название раздела присутствует на указанной странице:

- Используют нечёткое сопоставление для различий в форматировании
- Требуют рассуждения перед ответом
- Простой бинарный вывод

### 4. Промпты генерации структуры

Создают структуру, когда оглавление отсутствует:

- Используют теги границ страниц (`<physical_index_X>`)
- Просят сохранять оригинальные названия
- Промпты продолжения опираются на предыдущую структуру

## Паттерн «Thinking»

Большинство промптов PageIndex включают поле `"thinking"` в ожидаемом выводе:

```json
{
    "thinking": "<почему вы думаете...>",
    "answer": "yes or no"
}
```

Это форма **цепочки рассуждений** (chain-of-thought) — принуждение LLM рассуждать перед ответом повышает точность.

## Обработка длинных документов

Когда документ слишком длинный для одного промпта:

1. Страницы делятся на группы (с перекрытием для непрерывности)
2. Первая группа обрабатывается «инициализирующим» промптом
3. Последующие группы — промптами «продолжения» с предыдущими результатами
4. После каждого шага проверяется полнота

## Восстановление после ошибок

PageIndex включает циклы валидации:
- После каждого ответа LLM проверяется полнота вывода
- При неполноте отправляется промпт продолжения
- Лимит повторов предотвращает бесконечные циклы

## Итоги

Промпты PageIndex тщательно спроектированы: структурированные форматы вывода, цепочки рассуждений, нечёткое сопоставление и стратегии продолжения. Эти паттерны — ключ к высокой точности генерации деревьев.
