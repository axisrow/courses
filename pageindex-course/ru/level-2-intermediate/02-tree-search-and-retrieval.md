---
title: "Поиск по дереву и извлечение"
weight: 2
bookToc: true
---

# Поиск по дереву и извлечение

## От дерева к ответам

После построения древовидной структуры начинается вторая фаза — поиск по дереву (tree search).

## Как работает поиск по дереву

Поиск вдохновлён **AlphaGo** — ИИ, победившим чемпиона мира по го. Как AlphaGo оценивает возможные ходы, PageIndex оценивает пути по дереву документа.

Процесс идёт сверху вниз:

1. **Начало с корня** — просмотр всех разделов верхнего уровня
2. **Оценка релевантности** — LLM читает названия и резюме, рассуждает о содержимом
3. **Спуск в наиболее перспективную ветку** — углубление в дерево
4. **Повторение** — до достижения наиболее конкретного раздела
5. **Извлечение контента** — получение текста с определённых страниц

## Пример

**Вопрос**: *«Каков темп роста выручки компании в 3-м квартале?»*

```
Годовой отчёт 2023
├── Письмо акционерам          → Возможно релевантно
├── Обзор компании              → Маловероятно
├── Финансовая отчётность       → Очень вероятно ✓
│   ├── Отчёт о прибылях       → Очень вероятно ✓
│   │   ├── Поквартальная разбивка → Наиболее релевантно ✓✓
│   │   └── Годовой итог        → Менее релевантно
│   ├── Балансовый отчёт        → Не релевантно
│   └── Движение денежных средств → Не релевантно
└── Факторы риска               → Не релевантно
```

## Роль резюме

Каждый узел дерева содержит **резюме** — краткое описание содержания раздела. Резюме помогают LLM принимать решения, не читая полный текст каждого раздела.

## Извлечение с контекстом

Когда PageIndex определяет релевантный раздел, он возвращает контент с **полным контекстом**:

- К какому разделу относится
- Какой диапазон страниц охватывает
- Как вписывается в общую структуру документа

Это делает итоговый ответ ИИ более точным и проверяемым.

## Почему это лучше плоского поиска

| Плоский поиск | Поиск по дереву |
|---------------|-----------------|
| Ищет по всем 300 страницам | Проходит 3-4 уровня дерева |
| Возвращает фрагменты без контекста | Возвращает полные разделы с контекстом |
| Не может объяснить выбор | Показывает путь рассуждения |

## Итоги

Поиск по дереву использует рассуждения LLM для навигации по иерархии документа уровень за уровнем. Вместе с резюме узлов и извлечением с контекстом это даёт более точные и объяснимые результаты.
