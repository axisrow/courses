---
title: "PageIndex 中的提示工程"
weight: 2
bookToc: true
---

# PageIndex 中的提示工程

## PageIndex 如何与大语言模型对话

PageIndex 大量依赖精心设计的提示词来引导大语言模型完成各种任务。理解这些提示词可以揭示系统如何实现高准确率。

## 提示词的类型

### 1. 检测提示词

用于检测页面是否包含目录。关键设计：
- 明确排除常见的误判（图表列表、符号列表）
- 要求结构化 JSON 输出，包含"thinking"字段
- 二元判断（是/否）

### 2. 提取提示词

用于提取和结构化目录内容。关键设计：
- 用示例定义精确的输出格式
- 解释"结构"的含义（编号系统）
- 处理超出 token 限制的长目录的续接

### 3. 验证提示词

用于检查章节标题是否真的出现在指定页面。关键设计：
- 使用模糊匹配处理格式差异
- 要求先推理（"thinking"字段）再给出答案
- 简单的二元输出

### 4. 结构生成提示词

当没有目录时，从内容生成结构。关键设计：
- 使用特殊的页面边界标签（`<physical_index_X>`）帮助模型追踪页码
- 要求使用原始标题（不要改写）
- 续接提示词基于之前的结构继续构建

## "思考"模式

大多数 PageIndex 提示词在输出中包含 `"thinking"` 字段：

```json
{
    "thinking": "<你为什么认为...>",
    "answer": "yes or no"
}
```

这是一种**思维链提示**——强迫大语言模型在回答前先推理，提高了准确率。

## 处理长文档

当文档太长无法放入单个提示词时，PageIndex：

1. 将页面分组（带重叠以保持连续性）
2. 用"初始化"提示词处理第一组
3. 用包含之前结果的"续接"提示词处理后续组
4. 每步之后检查完整性

## 提示词中的错误恢复

PageIndex 包含验证循环：
- 每次大语言模型响应后检查输出是否完整
- 如果不完整，发送续接提示词
- 最大重试次数防止无限循环

## 总结

PageIndex 的提示词经过精心设计，采用结构化输出格式、思维链推理、模糊匹配和续接策略。这些设计模式是实现高准确率树结构生成的关键。
