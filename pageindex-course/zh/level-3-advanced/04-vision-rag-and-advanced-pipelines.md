---
title: "视觉 RAG 与高级流水线"
weight: 4
bookToc: true
---

# 视觉 RAG 与高级流水线

## 超越文本：基于视觉的 RAG

传统的文档处理依赖从 PDF 中提取文本。但许多文档包含难以用文本捕获的信息：图表、示意图、复杂表格和特殊排版。

PageIndex 支持**视觉 RAG**——直接使用页面图片而非提取文本的流水线。

## 视觉 RAG 的工作原理

1. **将 PDF 页面转为图片** — 每页变成一个图片文件
2. **构建树结构** — 使用文本提取来建立结构
3. **检索时发送页面图片** — 不发送文本，而是将实际页面图片发给大语言模型
4. **大语言模型阅读图片** — 现代视觉模型可以直接理解图表、表格和排版

## 视觉 RAG 的优势

| 特点 | 基于文本的 RAG | 视觉 RAG |
|------|--------------|----------|
| 图表和图形 | 丢失或转换不佳 | 完全可见 |
| 复杂表格 | 常常破损 | 完整保留 |
| 格式和排版 | 丢失 | 保留 |
| OCR 错误 | 常见 | 无 |
| 处理成本 | 较低 | 较高 |

## 构建高级 RAG 流水线

一个完整的基于 PageIndex 的 RAG 系统包含几个组件：

### 组件一：文档预处理

```python
from pageindex import page_index
tree = page_index("document.pdf", if_add_node_summary="yes")
```

### 组件二：查询理解

在搜索树之前，分析用户的问题：需要什么类型的信息？是数字、文本还是视觉内容？

### 组件三：树导航

使用大语言模型基于查询在树中导航，从顶层开始逐层选择最相关的分支。

### 组件四：内容提取

从原始文档中提取相关页面——文本 RAG 提取文字，视觉 RAG 提取页面图片。

### 组件五：答案生成

将提取的内容和原始问题一起发送给大语言模型生成回答。

## 代理式检索

最高级的用法是**代理式检索**——AI 代理可以：
- 多次遍历树
- 组合来自不同章节的信息
- 提出后续问题缩小结果范围
- 对照文档验证自己的回答

## 与其他工具组合

PageIndex 可以与以下工具结合：
- **MCP**：让 AI 助手将 PageIndex 作为工具使用
- **LangChain / LlamaIndex**：作为现有框架中的检索器
- **自定义流水线**：为特定领域构建专用工作流

## 总结

视觉 RAG 将 PageIndex 扩展到处理视觉丰富的文档。高级流水线结合树导航、视觉能力和代理式检索，处理最复杂的文档分析任务。
