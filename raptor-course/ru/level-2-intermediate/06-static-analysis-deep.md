---
title: "Глубокое погружение: статический анализ"
weight: 1
bookToc: true
---

## Глубокое погружение: статический анализ

### Два движка — одна цель

RAPTOR использует два взаимодополняющих движка:

#### Semgrep

Semgrep — инструмент сопоставления шаблонов. Он ищет код, соответствующий известным паттернам уязвимостей. RAPTOR поставляется с правилами в `engine/semgrep/rules/`:

- `sinks/ssrf.yaml` — SSRF
- `injection/sql-concat.yaml` — SQL-инъекция через конкатенацию строк
- `injection/command-taint.yaml` — инъекция команд
- `crypto/weak-hash.yaml` — слабые хэш-алгоритмы
- `secrets/hardcoded-api-key.yaml` — захардкоженные API-ключи
- `auth/tls-skip-verify.yaml` — отключённая проверка TLS

#### CodeQL

CodeQL — движок семантического анализа от GitHub. В отличие от шаблонного сопоставления Semgrep, CodeQL понимает **поток данных** — он может отследить, как ненадёжный ввод пользователя проходит через программу к опасной функции.

### Когда какой использовать

| Особенность | Semgrep | CodeQL |
|-------------|---------|--------|
| Скорость | Очень быстрый | Медленнее (строит базу данных) |
| Точность | На основе шаблонов | С учётом потока данных |
| Настройка | Минимальная | Требует создания базы |

### Запуск CodeQL отдельно

```
/codeql
```

### Валидация потока данных

RAPTOR пытается подтвердить находки, отслеживая поток данных от **источника** (ввод пользователя) до **приёмника** (опасная функция). Подтверждённые находки с гораздо большей вероятностью являются реальными уязвимостями.

### Главный вывод

Используйте Semgrep для быстрых широких сканирований. Используйте CodeQL для глубокого анализа с меньшим количеством ложных срабатываний. RAPTOR объединяет оба для лучших результатов.
