---
title: "Создание собственных MCP-серверов"
weight: 11
bookToc: true
---

# Создание собственных MCP-серверов

## Зачем создавать свой?

Sentient поставляется с 20+ интеграциями, но вам может понадобиться подключить сервис, которого ещё нет — внутренний API компании, нишевый SaaS или систему умного дома.

## Структура MCP-сервера

Каждый MCP-сервер в `src/server/mcp_hub/` следует одному шаблону:

```
my_service/
├── main.py        # Определения инструментов и обработчики
├── auth.py        # Логика аутентификации
├── utils.py       # Вспомогательные функции
├── prompts.py     # Промпты для AI
└── test_client.py # Тесты
```

## Пошаговое создание

### 1. Создайте папку

```bash
mkdir src/server/mcp_hub/my_service
```

### 2. Определите инструменты в `main.py`

```python
async def get_items(query: str) -> dict:
    """Поиск элементов в My Service."""
    response = await client.get(f"/api/items?q={query}")
    return response.json()
```

### 3. Настройте аутентификацию в `auth.py`

Для OAuth следуйте примеру `gmail/auth.py`. Для API-ключей используйте `.env` и `python-dotenv`.

### 4. Напишите промпты в `prompts.py`

```python
SYSTEM_PROMPT = """
Используй инструменты my_service, когда пользователь спрашивает
об инвентаре, доступности товаров или статусе заказа.
"""
```

### 5. Зарегистрируйте MCP-сервер

Добавьте новый сервер в конфигурацию оркестратора.

### 6. Протестируйте

Используйте `test_client.py` для проверки перед подключением к AI.

## Лучшие практики

- Один инструмент — одно действие.
- Возвращайте структурированные данные (JSON).
- Обрабатывайте ошибки и возвращайте понятные сообщения.
- Пишите чёткие описания для AI.

## Итог

Создание MCP-сервера занимает около часа. Это самый мощный способ расширить Sentient под ваши нужды.
